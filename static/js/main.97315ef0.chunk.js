(this["webpackJsonpnudle-meet-frontend"]=this["webpackJsonpnudle-meet-frontend"]||[]).push([[0],{103:function(e,t){},105:function(e,t){},116:function(e,t,a){},132:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(35),o=a.n(c),s=(a(83),a(2)),u=a(26),i=a(32),l=i.c,d=function(){return Object(i.b)()},m=a(6),p=a.n(m),j=a(17),f="https://pure-shelf-86630.herokuapp.com/api",h=function(){var e=Object(j.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x("/rooms");case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_=function(){var e=Object(j.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S("/rooms?name=".concat(t));case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(j.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x("/rooms/".concat(t));case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=Object(j.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v("/rooms/".concat(t));case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(j.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(f).concat(t),{method:"DELETE"});case 2:if((a=e.sent).ok){e.next=5;break}throw new Error("Could not fetch '".concat(t,"', received '").concat(a.status,"'"));case 5:return e.next=7,a.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=Object(j.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(f).concat(t),{method:"GET"});case 2:if((a=e.sent).ok){e.next=5;break}throw new Error("Could not fetch '".concat(t,"', received '").concat(a.status,"'"));case 5:return e.next=7,a.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=Object(j.a)(p.a.mark((function e(t){var a,n,r,c=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=c.length>1&&void 0!==c[1]?c[1]:{},n={method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(a)},e.next=4,fetch("".concat(f).concat(t),n);case 4:if((r=e.sent).ok){e.next=7;break}throw new Error("Could not fetch ".concat(t)+", received ".concat(r.status));case 7:return e.next=9,r.json();case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g="GET_ROOMS_REQUEST",y="GET_ITEMSROOMS_SUCCESS",E="GET_ROOMS_FAILED",B="POST_ROOMS_REQUEST",w="POST_ROOMS_SUCCESS",N="POST_ROOMS_FAILED",R="GET_ROOM_BY_ID_REQUEST",M="GET_ROOM_BY_ID_SUCCESS",T="GET_ROOM_BY_ID_FAILED",C="WS_CONNECTION_START",D="WS_CONNECTION_SUCCESS",U="WS_GET_MESSAGE",I="WS_SEND_MESSAGE",P="SET_USER_SUCCESS",k="DELETE_LEAVE_REQUEST",V="DELETE_LEAVE_SUCCESS",q="DELETE_LEAVE_FAILED",F=function(e){return{type:E,payload:e}},L=function(e){return{type:T,payload:e}},W=function(e){return{type:N,payload:e}},A=function(e){return{type:q,payload:e}},G=function(e){return function(t){t({type:k}),O(e).then((function(e){e&&e.success?t(function(e){return{type:V,payload:e}}(e)):t(A(e.reason))})).catch((function(e){t(A(e))}))}},Y=function(){return function(e){e({type:g}),h().then((function(t){t&&t.success?e(function(e){return{type:y,payload:e}}(t)):e(F(t.reason))})).catch((function(t){e(F(t))}))}},X=function(e){return function(t){t({type:B}),_(e).then((function(e){e&&e.success?t(function(e){return{type:w,payload:e}}(e)):t(W(e.reason))})).catch((function(e){t(W(e))}))}},z=function(e){return function(t){t({type:R}),b(e).then((function(e){e&&e.success?t(function(e){return{type:M,payload:e}}(e)):t(L("Some error"))})).catch((function(e){t(L(e))}))}},J=a(37);a(71);function K(){return(K=Object(j.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",navigator.mediaDevices.getDisplayMedia());case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Q=a(7),H=a.n(Q),Z=a(1),$=function(e){var t=Object(n.useState)({localStream:{},remoteStreamUrl:"",streamUrl:"",initiator:!1,peer:{},full:!1,connecting:!1,waiting:!0,micState:!0,camState:!0}),a=Object(u.a)(t,2),r=a[0],c=a[1],o=Object(n.useRef)(null),s=Object(n.useRef)(null);function i(){(function(){return K.apply(this,arguments)})().then((function(e){e.oninactive=function(){r.peer.removeStream(r.localStream),new Promise((function(e,t){navigator.getUserMedia=navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,navigator.getUserMedia({video:!0,audio:!0},(function(t){c({streamUrl:t,localStream:t}),o&&(o.current.srcObject=t),e()}),(function(){}))})).then((function(){r.peer.addStream(r.localStream)}))},c({streamUrl:e,localStream:e}),o.current.srcObject=e,r.peer.addStream(e)}))}return Object(Z.jsxs)(Z.Fragment,{children:[Object(Z.jsx)("video",{autoPlay:!0,id:"localVideo",muted:!0,ref:o,className:H.a.video}),Object(Z.jsxs)("div",{className:"".concat(r.connecting||r.waiting?"hide":""," ").concat(H.a.videoRemoteContainer),children:[Object(Z.jsx)("video",{autoPlay:!0,id:"remoteVideo",ref:s,className:H.a.videoRemote}),Object(Z.jsx)("video",{autoPlay:!0,id:"remoteVideo",ref:s,className:H.a.videoRemote}),Object(Z.jsx)("video",{autoPlay:!0,id:"remoteVideo",ref:s,className:H.a.videoRemote})]}),Object(Z.jsxs)("div",{className:H.a.controlBar,children:[Object(Z.jsx)("button",{className:H.a.exitButton,onClick:e.leaveRoom,children:"Exit"}),Object(Z.jsx)("button",{className:r.micState?"".concat(H.a.toogleMicButton," ").concat(H.a.pressed):H.a.toogleMicButton,onClick:function(){r.localStream.getAudioTracks().length>0&&r.localStream.getAudioTracks().forEach((function(e){e.enabled=!e.enabled})),c({micState:!r.micState})},children:"Mic"}),Object(Z.jsx)("button",{className:r.camState?"".concat(H.a.toogleVideoButton," ").concat(H.a.pressed):H.a.toogleVideoButton,onClick:function(){r.localStream.getVideoTracks().length>0&&r.localStream.getVideoTracks().forEach((function(e){e.enabled=!e.enabled})),c({camState:!r.camState})},children:"Video"}),Object(Z.jsx)("button",{className:H.a.toogleVideoButton,onClick:function(){i()},children:"Share"})]}),Object(Z.jsx)("div",{className:"controls"})]})},ee=a(5),te=a.n(ee),ae=a(20),ne=a.n(ae);var re=function(e){var t,a,n;return Object(Z.jsxs)("div",{className:"".concat(ne.a.message," ").concat(e.own?ne.a.own:""),children:[Object(Z.jsxs)("div",{className:ne.a.top,children:[Object(Z.jsx)("span",{className:ne.a.name,children:null===(t=e.message)||void 0===t?void 0:t.user}),Object(Z.jsx)("span",{className:ne.a.date,children:null===(a=e.message)||void 0===a?void 0:a.date})]}),Object(Z.jsx)("div",{className:ne.a.bottom,children:Object(Z.jsx)("p",{className:ne.a.text,children:null===(n=e.message)||void 0===n?void 0:n.text})})]})},ce=a(72);var oe=function(){var e=d(),t=l((function(e){return e.rooms.roomByIDSuccess})),a=l((function(e){return e.rooms.user})),c=l((function(e){return e.rooms.roomsSuccess})),o=Object(s.g)(),i=Object(n.useRef)(null),m=Object(n.useRef)(null);r.a.useEffect((function(){e(Y()),e(z(o.name))}),[e,o.name]),r.a.useEffect((function(){m&&m.current.focus(),Object(ce.setTimeout)((function(){i&&i.current.scrollIntoView()}),1)}));var p=Object(s.f)(),j=function(){e(G(o.name)),p.push("/",{name:o.name})},f=r.a.useState(""),h=Object(u.a)(f,2),_=h[0],b=h[1],O=function(t){t.preventDefault();var n={room:o.name,user:a,messageText:_};e(function(e){return{type:I,payload:e}}(n)),b("")};return a||j(),Object(Z.jsxs)("div",{className:te.a.messenger,children:[Object(Z.jsx)("div",{className:te.a.chatUsers,children:Object(Z.jsxs)("div",{className:te.a.chatUsersWrapper,children:[Object(Z.jsx)("p",{children:"Rooms"}),c&&c.map((function(e){return Object(Z.jsx)("p",{className:te.a.user,onClick:function(){p.push("/".concat(e.owner))},children:e.owner})}))]})}),Object(Z.jsx)("div",{className:te.a.chatUsers,children:Object(Z.jsxs)("div",{className:te.a.chatUsersWrapper,children:[Object(Z.jsx)("p",{children:"Users"}),t.users&&t.users.map((function(e){return Object(Z.jsx)("p",{className:te.a.user,children:e.name},e.name)}))]})}),Object(Z.jsx)("div",{className:te.a.chatMain,children:Object(Z.jsx)("div",{className:te.a.chatMainWrapper,children:Object(Z.jsx)("div",{className:te.a.streamVIdeo,children:Object(Z.jsx)($,{leaveRoom:j})})})}),Object(Z.jsx)("div",{className:te.a.chatBox,children:Object(Z.jsxs)("div",{className:te.a.chatBoxWrapper,children:[Object(Z.jsxs)("div",{className:te.a.chatBoxTop,children:[t.messages&&t.messages.map((function(e){return Object(Z.jsx)(re,{message:e,own:(null===e||void 0===e?void 0:e.user)===a})})),Object(Z.jsx)("div",{ref:i})]}),Object(Z.jsxs)("form",{className:te.a.chatBoxBottom,onSubmit:function(e){O(e)},children:[Object(Z.jsx)("textarea",{ref:m,className:te.a.chatMessageInput,placeholder:"Share your thoughts...",value:_,name:"messageText",onChange:function(e){!function(e){b(e.target.value)}(e)}}),Object(Z.jsx)("button",{className:te.a.chatMessageSubmitButton,children:"Share"})]})]})})]})};var se=function(){var e=r.a.useState(""),t=Object(u.a)(e,2),a=t[0],n=t[1],c=Object(s.f)(),o=l((function(e){return e.rooms.roomSuccess})),i=l((function(e){return e.rooms.roomFailed}));r.a.useEffect((function(){var e,t;(null===(e=c.location.state)||void 0===e?void 0:e.name)&&n(null===(t=c.location.state)||void 0===t?void 0:t.name)}),[c]);var m=d();return(null===o||void 0===o?void 0:o.owner)&&c.push("/".concat(a),{owner:!0}),Object(Z.jsx)("div",{className:te.a.login,children:Object(Z.jsxs)("form",{onSubmit:function(e){return function(e){e.preventDefault(),m(X(a))}(e)},className:te.a.card,children:[i?Object(Z.jsx)("span",{className:"".concat(te.a.label," ").concat(te.a.error),children:i}):Object(Z.jsx)("span",{className:"".concat(te.a.label),children:"Enter your name"}),Object(Z.jsx)("input",{type:"text",placeholder:"Name",value:a,name:"name",onChange:function(e){!function(e){n(e.target.value)}(e)},className:te.a.cardInput}),Object(Z.jsx)("button",{className:te.a.cardButton,children:"Create a nudle"})]})})};a(116);var ue=function(){var e=d();return r.a.useEffect((function(){e({type:C})}),[e]),Object(Z.jsx)(Z.Fragment,{children:Object(Z.jsxs)(s.c,{children:[Object(Z.jsx)(s.a,{path:"/:name",children:Object(Z.jsx)(oe,{})}),Object(Z.jsx)(s.a,{path:"/",children:Object(Z.jsx)(se,{})})]})})},ie=a(73),le=a(78),de=a(77),me=function(e){Object(le.a)(a,e);var t=Object(de.a)(a);function a(){var e;Object(J.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={hasError:!1},e}return Object(ie.a)(a,[{key:"componentDidCatch",value:function(){this.setState({hasError:!0})}},{key:"render",value:function(){return this.state.hasError?Object(Z.jsx)("div",{children:"Error"}):this.props.children}}]),a}(n.Component),pe=a(76),je=a(27),fe=a(74),he=a(3),_e={roomsSuccess:[],roomsRequest:!1,roomsFailed:!1,roomSuccess:{},roomRequest:!1,roomFailed:!1,roomByIDSuccess:[],roomByIDRequest:!1,roomByIDFailed:!1,user:null},be=Object(je.b)({rooms:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_e,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g:return Object(he.a)(Object(he.a)({},e),{},{roomsRequest:!0});case y:return Object(he.a)(Object(he.a)({},e),{},{roomsFailed:!1,roomsSuccess:t.payload.rooms,roomsRequest:!1});case E:return Object(he.a)(Object(he.a)({},e),{},{roomsFailed:t.payload,roomsRequest:!1});case B:return Object(he.a)(Object(he.a)({},e),{},{roomRequest:!0});case w:return Object(he.a)(Object(he.a)({},e),{},{roomFailed:!1,roomSuccess:t.payload.room,roomRequest:!1,user:t.payload.room.owner});case P:return Object(he.a)(Object(he.a)({},e),{},{user:t.payload.user});case N:return Object(he.a)(Object(he.a)({},e),{},{roomFailed:t.payload,roomRequest:!1});case R:return Object(he.a)(Object(he.a)({},e),{},{roomByIDRequest:!0});case M:return Object(he.a)(Object(he.a)({},e),{},{roomByIDFailed:!1,roomByIDSuccess:t.payload.data,roomByIDRequest:!1});case T:return Object(he.a)(Object(he.a)({},e),{},{roomByIDFailed:t.payload,roomByIDRequest:!1});case U:var a=Object(he.a)({},e.roomByIDSuccess);return e.roomByIDSuccess.owner===t.payload.owner?(a.messages=t.payload.messages,Object(he.a)(Object(he.a)({},e),{},{roomByIDSuccess:a})):Object(he.a)({},e);case k:return Object(he.a)(Object(he.a)({},e),{},{roomByIDRequest:!0});case V:return _e;case q:return Object(he.a)(Object(he.a)({},e),{},{roomByIDFailed:t.payload,roomByIDRequest:!1});default:return e}}}),Oe=a(75),ve=a.n(Oe),xe=("object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):je.c)(Object(je.a)((function(e){var t=null;return function(a){return function(n){var r=e.dispatch,c=n.type,o=n.payload;if(c===C&&(t=ve.a.connect("wss://pure-shelf-86630.herokuapp.com/api")),t&&(t.on("connection",(function(e){r({type:D,payload:e})})),t.once("message_new_to_client",(function(e){r(function(e){return{type:U,payload:e}}(e))})),c===I)){var s=o;t.emit("message_new",s)}a(n)}}}),fe.a)),Se=Object(je.d)(be,xe);o.a.render(Object(Z.jsx)(r.a.StrictMode,{children:Object(Z.jsx)(me,{children:Object(Z.jsx)(i.a,{store:Se,children:Object(Z.jsx)(pe.a,{children:Object(Z.jsx)(ue,{})})})})}),document.getElementById("root"))},20:function(e,t,a){e.exports={message:"Message_message__2yI55",own:"Message_own__3eHsq",bottom:"Message_bottom__3zSHz",text:"Message_text__1hSrg",top:"Message_top__1kMH_",name:"Message_name__3_KhC"}},5:function(e,t,a){e.exports={messenger:"Pages_messenger__n_CzL",chatUsers:"Pages_chatUsers__3lK-U",chatMain:"Pages_chatMain__3mygK",chatBox:"Pages_chatBox__1TB5S",chatMainWrapper:"Pages_chatMainWrapper__nS8d3",chatBoxWrapper:"Pages_chatBoxWrapper__1kd-1",chatBoxTop:"Pages_chatBoxTop__1jscp",chatBoxBottom:"Pages_chatBoxBottom__2vqPy",chatMessageInput:"Pages_chatMessageInput__39qLU",chatMessageSubmitButton:"Pages_chatMessageSubmitButton__oJV3v",chatUsersWrapper:"Pages_chatUsersWrapper__vVow8",chatUsersSearch:"Pages_chatUsersSearch__3YgUf",classBoxMessage:"Pages_classBoxMessage__13_0a",user:"Pages_user__13ur3",streamVIdeo:"Pages_streamVIdeo__2ObdY",login:"Pages_login__2D0Bh",card:"Pages_card__39GcX",label:"Pages_label__3pRYZ",error:"Pages_error__1SxUK",cardInput:"Pages_cardInput__3UODr",cardButton:"Pages_cardButton__1To5q"}},7:function(e,t,a){e.exports={video:"videoCall_video__cDddn",videoRemoteContainer:"videoCall_videoRemoteContainer__3qvUf",videoRemote:"videoCall_videoRemote__3T1pl",controlBar:"videoCall_controlBar__37diF",exitButton:"videoCall_exitButton__n2DUl",pressed:"videoCall_pressed__14tk-"}},83:function(e,t,a){}},[[132,1,2]]]);
//# sourceMappingURL=main.97315ef0.chunk.js.map